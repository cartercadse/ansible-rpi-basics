---
- name: Install Python Package rpi_hardware_pwm
  pip:
    name: rpi_hardware_pwm
    executable: pip3

- name: Update /boot/config.txt
  lineinfile:
    path: /boot/config.txt
    regexp: "{{ item.regexp }}"
    line: "{{ item.line }}"
    insertafter: EOF
    state: present
  with_items: "{{ rpifancontrol_boot_config_options }}"
  notify: reboot

- name: Transfer RPiFanControl.py to /usr/local/bin/.
  copy:
    src: scripts/RPiFanControl/RPiFanControl.py
    dest: /usr/local/bin/RPiFanControl.py
  notify: update RPiFanControl

- name: Transfer RPiFanControl.service to /etc/systemd/system/.
  copy:
    src: scripts/RPiFanControl/RPiFanControl.service
    dest: /etc/systemd/system/RPiFanControl.service    
  notify: update RPiFanControl

- name: Flush Handlers
  meta: flush_handlers